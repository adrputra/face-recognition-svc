version: '3.8'

services:
  face-recognition-svc:
    image: ${DOCKER_USERNAME}/${SERVICE_NAME}:latest
    ports:
      - "8001:8001"
    environment:
      - PORT=8001
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure
      resources:
        limits:
          memory: 512M
        reservations:
          memory: 256M
    networks:
      - main-dev
    secrets:
      - db_username
      - db_password
      - auth_access_secret
      - auth_refresh_secret
      - redis_password
      - minio_username
      - minio_secret_key
      - rabbitmq_username
      - rabbitmq_password

networks:
  main-dev:
    external: true

secrets:
  db_username:
    external: true
  db_password:
    external: true
  auth_access_secret:
    external: true
  auth_refresh_secret:
    external: true
  redis_password:
    external: true
  minio_username:
    external: true
  minio_secret_key:
    external: true
  rabbitmq_username:
    external: true
  rabbitmq_password:
    external: true


